# Thay đổi ID từ UUID sang số tự tăng

## ✅ Đã hoàn thành

### Thay đổi chính:

**TRƯỚC:** ID là UUID (string dài)
```
id: "a1b2c3d4-e5f6-7890-abcd-ef1234567890"
```

**SAU:** ID là số tự tăng (integer)
```
id: 0, 1, 2, 3, 4, 5...
```

### Chi tiết thay đổi:

#### 1. **Database Schema (database.py)**
- **garena_accounts.id**: VARCHAR(255) → `INT AUTO_INCREMENT PRIMARY KEY`
- **creation_jobs.job_id**: VARCHAR(255) → `INT AUTO_INCREMENT PRIMARY KEY`
- MySQL tự động tạo ID từ 1, 2, 3...

#### 2. **Pydantic Models (server.py)**
```python
# TRƯỚC
id: str = Field(default_factory=lambda: str(uuid.uuid4()))

# SAU  
id: Optional[int] = None  # Auto-generated by MySQL
```

#### 3. **Database Operations**
- `insert_account()`: Trả về `cursor.lastrowid` (ID vừa tạo)
- `insert_job()`: Trả về `cursor.lastrowid` (job_id vừa tạo)
- Tất cả `find_*`, `update_*`, `delete_*` giờ nhận `int` thay vì `str`

#### 4. **API Endpoints**
Tất cả endpoints với `{account_id}` và `{job_id}` giờ nhận số nguyên:

**Ví dụ:**
```
TRƯỚC: /api/accounts/a1b2c3d4-e5f6-7890/inbox
SAU:   /api/accounts/1/inbox

TRƯỚC: /api/accounts/job/xyz-123-abc
SAU:   /api/accounts/job/1
```

### Cách hoạt động:

**Khi tạo account mới:**
1. Backend tạo account với username, email, password
2. MySQL auto-generate ID: 1, 2, 3, 4...
3. `insert_account()` trả về ID vừa tạo
4. ID được lưu vào job.accounts array

**Frontend:**
- Tất cả requests giờ dùng số thay vì UUID
- Checkbox selection dùng integer IDs
- Delete multiple: `[1, 3, 5]` thay vì `["uuid1", "uuid2", "uuid3"]`

### Ví dụ API Response:

**GET /api/accounts**
```json
[
  {
    "id": 1,
    "username": "player123456",
    "email": "abc@2200freefonts.com",
    "password": "Pass123!@#",
    "status": "created"
  },
  {
    "id": 2,
    "username": "gamer789012",
    "email": "xyz@2200freefonts.com",
    "password": "Secure#456",
    "status": "created"
  }
]
```

**POST /api/accounts/create → Response:**
```json
{
  "job_id": 5,
  "message": "Started creating 3 accounts with mail.tm",
  "status": "processing"
}
```

### Lợi ích:

✅ **Dễ đọc**: ID = 1, 2, 3 thay vì UUID dài
✅ **Tiết kiệm**: INT (4 bytes) vs VARCHAR(36 bytes)
✅ **Performance**: Index int nhanh hơn string
✅ **User-friendly**: Dễ nhớ và tham chiếu
✅ **Database**: MySQL auto-increment tối ưu

### Migration:

**Nếu đã có database cũ với UUID:**
```sql
-- Xóa database cũ (cẩn thận - mất data!)
DROP DATABASE garena_creator_db;

-- Tạo lại database mới
CREATE DATABASE garena_creator_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;

-- Backend sẽ tự động tạo tables mới với INT ID
```

**Hoặc giữ data cũ:**
```sql
-- Backup data
CREATE TABLE garena_accounts_backup AS SELECT * FROM garena_accounts;

-- Tạo table mới với INT ID
DROP TABLE garena_accounts;
-- Backend sẽ tự tạo table mới khi restart

-- Migrate data (phải map UUID → INT manually)
```

### Lưu ý:

- ⚠️ ID bắt đầu từ **1** (không phải 0) vì MySQL AUTO_INCREMENT
- ⚠️ Nếu xóa ID=5, ID tiếp theo vẫn là 6 (không tái sử dụng ID cũ)
- ✅ ID không bao giờ trùng
- ✅ ID không bao giờ thay đổi sau khi tạo
- ✅ Thread-safe với MySQL AUTO_INCREMENT

### Reset ID về 1:

```sql
-- Xóa tất cả accounts và reset counter
TRUNCATE TABLE garena_accounts;

-- Hoặc reset counter mà không xóa data
ALTER TABLE garena_accounts AUTO_INCREMENT = 1;
```

### Kiểm tra ID tiếp theo:

```sql
SELECT AUTO_INCREMENT 
FROM information_schema.TABLES 
WHERE TABLE_SCHEMA = 'garena_creator_db' 
AND TABLE_NAME = 'garena_accounts';
```
